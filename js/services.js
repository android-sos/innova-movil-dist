angular.module("app.services",[]).service("$pouchDB",["$rootScope","$q",function(t,n){var e,r;this.setDatabase=function(t){e=new PouchDB(t)},this.startListening=function(){r=e.changes({live:!0,include_docs:!0}).on("change",function(n){n.deleted?t.$broadcast("$pouchDB:delete",n):t.$broadcast("$pouchDB:change",n)})},this.stopListening=function(){r.cancel()},this.sync=function(t){e.sync(t,{live:!0,retry:!0})},this.save=function(t){var r=n.defer();return t._id?e.put(t).then(function(t){r.resolve(t)})["catch"](function(t){r.reject(t)}):e.post(t).then(function(t){r.resolve(t)})["catch"](function(t){r.reject(t)}),r.promise},this["delete"]=function(t,n){return e.remove(t,n)},this.get=function(t){return e.get(t)},this.destroy=function(){e.destroy()}}]).factory("BlankFactory",[function(){}]).constant("AUTH_EVENTS",{notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{admin:"admin_role","public":"public_role"}).service("AuthService",["$q","$http","USER_ROLES",function(t,n,e){function r(){var t=window.localStorage.getItem(a);t&&u(t)}function o(t){window.localStorage.setItem(a,t),u(t)}function u(t){f=t.split(".")[0],s=!0,c=t,"admin"==f&&(d=e.admin),"user"==f&&(d=e["public"]),n.defaults.headers.common["X-Auth-Token"]=t}function i(){c=void 0,f="",s=!1,n.defaults.headers.common["X-Auth-Token"]=void 0,window.localStorage.removeItem(a)}var c,a="TOKEN_KEY",f="",s=!1,d="",l=function(n,e){return t(function(t,n){c=e,o(c),t("Login success.")})},h=function(){i()},p=function(t){return angular.isArray(t)||(t=[t]),s&&-1!==t.indexOf(d)};return r(),{login:l,logout:h,isAuthorized:p,isAuthenticated:function(){return s},username:function(){return f},role:function(){return d}}}]).factory("authInterceptor",["$rootScope","$q","$window",function(t,n,e){return{request:function(t){return t.headers=t.headers||{},e.sessionStorage.token&&(t.headers.Authorization=e.sessionStorage.token),t},response:function(t){return 401===t.status,t||n.when(t)}}}]).factory("httpInterceptor",["$timeout","$injector","$q",function(t,n,e){function r(){n.get("$ionicLoading").show({template:'<ion-spinner icon="bubbles"></ion-spinner',animation:"fade-in",showBackdrop:!0})}function o(){n.get("$ionicLoading").hide()}var u;return{request:function(t){return u=!0,r(),t},response:function(n){return u=!1,t(function(){u||o()},300),n},requestError:function(t){return o(),console.log("Request Error logging via interceptor"),t},responseError:function(t){return o(),console.log("Response error via interceptor"),e.reject(t)}}}]).factory("messageApi",["$http","$location",function(t,n){var e="api/v1/msg/",r={};return r.send_order_mail=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r}]).factory("userApi",["$http","$location",function(t,n){var e="api/v1/user/";console.log(e);var r={};return r.send_user_comment=function(n){return t.get("api/v1/msg/"+n).then(function(t){return t.data},function(t,n){})},r.getAll=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.get=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.post=function(n,r){return t.post(e+n,r).then(function(t){return t.data})},r.put=function(n,r){return t.put(e+n,r).then(function(t){return t.data})},r["delete"]=function(n){return t["delete"](e+n).then(function(t){return t.data})},r}]).factory("orderApi",["$http","$location",function(t,n){var e="api/v1/orders/",r={};return r.send_order_mail=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.get=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.post=function(n,r){return t.post(e+n,r).then(function(t){return t.data})},r.put=function(n,r){return t.put(e+n,r).then(function(t){return t.data})},r["delete"]=function(n){return t["delete"](e+n).then(function(t){return t.data})},r}]).factory("orderDetailApi",["$http","$location",function(t,n){var e="api/v1/orderdetail/",r={};return r.get=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.post=function(n,r){return t.post(e+n,r).then(function(t){return t.data})},r.put=function(n,r){return t.put(e+n,r).then(function(t){return t.data})},r["delete"]=function(n){return t["delete"](e+n).then(function(t){return t.data})},r}]).factory("productsApi",["$http","$location",function(t,n){var e="api/v1/products/",r={};return r.get=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.post=function(n,r){return t.post(e+n,r).then(function(t){return t.data})},r.put=function(n,r){return t.put(e+n,r).then(function(t){return t.data})},r["delete"]=function(n){return t["delete"](e+n).then(function(t){return t.data})},r}]).factory("orderPayApi",["$http","$location",function(t,n){var e="api/v1/orderspay/",r={};return r.get=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.post=function(n,r){return t.post(e+n,r).then(function(t){return t.data})},r.put=function(n,r){return t.put(e+n,r).then(function(t){return t.data})},r["delete"]=function(n){return t["delete"](e+n).then(function(t){return t.data})},r}]).factory("orderLicenseApi",["$http","$location",function(t,n){var e="api/v1/orderslicense/",r={};return r.get=function(n){return t.get(e+n).then(function(t){return t.data},function(t,n){})},r.post=function(n,r){return t.post(e+n,r).then(function(t){return t.data})},r.put=function(n,r){return t.put(e+n,r).then(function(t){return t.data})},r["delete"]=function(n){return t["delete"](e+n).then(function(t){return t.data})},r}]).factory("dateFactory",["$http",function(){var t={};return t.getToday=function(t){var n=new Date,e=("0"+n.getDate()).slice(-2),r=("0"+(n.getMonth()+1)).slice(-2);return"'"+n.getFullYear()+"-"+r+"-"+e+"'"},t.formatDate=function(t){var n=new Date(t||Date.now()),e=""+(n.getMonth()+1),r=""+n.getDate(),o=n.getFullYear();return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),[r,e,o].join("/")},t.formatDateSql=function(t){var n=new Date(t||Date.now()),e=""+(n.getMonth()+1),r=""+n.getDate(),o=n.getFullYear();return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),[o,r,e].join("/")},t}]).factory("componetFactory",["$http",function(){var t={};return t.showLoading=function(t){$injector.get("$ionicLoading").show({template:"Working...",noBackdrop:!0,duration:3e3})},t.hidreLoading=function(){$injector.get("$ionicLoading").hide()},t}]).factory("$localstorage",["$window","$ionicHistory","$state",function(t,n,e){return{set:function(n,e){t.localStorage.setItem(n,e)},get:function(n){return t.localStorage.getItem(n)||""},setObject:function(n,e){t.localStorage[n]=btoa(JSON.stringify(e))},getObject:function(n){return"undefined"==typeof t.localStorage[n]?!1:JSON.parse(atob(t.localStorage[n])||"{}")},removeKey:function(n){t.localStorage.removeItem(n)},clear:function(){t.localStorage.clear(),n.clearCache().then(function(){e.go("app.loginForm"),n.clearHistory()})}}}]);